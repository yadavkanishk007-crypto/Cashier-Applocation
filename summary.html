{% extends 'base.html' %}
{% block title %}Summary{% endblock %}

{% block content %}
<h2>Payments Summary</h2>

<form method="GET" action="{{ url_for('summary') }}" class="row g-3 mb-4">
  <div class="col-md-3">
    <label for="month" class="form-label">Filter by Month</label>
    <input type="text" class="form-control" id="month" name="month" value="{{ filter_month }}" placeholder="e.g., January" />
  </div>
  <div class="col-md-3">
    <label for="year" class="form-label">Filter by Year</label>
    <input type="text" class="form-control" id="year" name="year" value="{{ filter_year }}" placeholder="e.g., 2025" />
  </div>
  <div class="col-md-3 align-self-end">
    <button type="submit" class="btn btn-primary">Filter</button>
    <a href="{{ url_for('summary') }}" class="btn btn-secondary">Clear</a>
  </div>
</form>

<table class="table table-striped table-bordered">
  <thead>
    <tr>
      <th>Member ID</th>
      <th>Name</th>
      <th>Total Amount</th>
      <th>Number of Payments</th>
      <th>Last Payment Date</th>
    </tr>
  </thead>
  <tbody>
    {% for row in summary %}
    <tr>
      <td>{{ row.ID }}</td>
      <td>{{ row.Name }}</td>
      <td>â‚¹{{ "%.2f"|format(row.TotalAmount) }}</td>
      <td>{{ row.NumPayments }}</td>
      <td>{{ row.LastPayment.strftime("%Y-%m-%d %H:%M") if row.LastPayment else "N/A" }}</td>
    </tr>
    {% else %}
    <tr><td colspan="5">No data available.</td></tr>
    {% endfor %}
  </tbody>
</table>

<a href="{{ url_for('index') }}" class="btn btn-secondary mt-3">Back to Dashboard</a>
{% endblock %}
